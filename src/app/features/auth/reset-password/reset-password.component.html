<div class="reset-password-page">
    <!-- Background Decorations -->
    <div class="bg-decoration bg-decoration-1"></div>
    <div class="bg-decoration bg-decoration-2"></div>

    <div class="reset-password-container">
        <div class="reset-password-card">
            @if (isValidating()) {
            <!-- Loading State -->
            <div class="loading-wrapper">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p>Validating reset link...</p>
            </div>
            } @else if (!isTokenValid() && !isSuccess()) {
            <!-- Invalid Token -->
            <div class="error-wrapper">
                <div class="error-icon">
                    <i class="bi bi-x-circle-fill"></i>
                </div>
                <h2>Invalid Link</h2>
                <p>{{ errorMessage() }}</p>
                <a routerLink="/forgot-password" class="btn-request-new">
                    Request New Link <i class="bi bi-arrow-right ms-2"></i>
                </a>
            </div>
            } @else if (isSuccess()) {
            <!-- Success State -->
            <div class="success-wrapper">
                <div class="success-icon">
                    <i class="bi bi-check-circle-fill"></i>
                </div>
                <h2>Password Reset!</h2>
                <p>{{ successMessage() }}</p>
                <a routerLink="/login" class="btn-login">
                    Go to Login <i class="bi bi-arrow-right ms-2"></i>
                </a>
            </div>
            } @else {
            <!-- Reset Form -->
            <div class="card-header">
                <div class="icon-wrapper">
                    <i class="bi bi-key-fill"></i>
                </div>
                <h2>Reset Your Password</h2>
                <p>Enter your new password below.</p>
            </div>

            @if (errorMessage()) {
            <div class="alert alert-danger">
                <i class="bi bi-exclamation-triangle-fill"></i>
                {{ errorMessage() }}
            </div>
            }

            <form (ngSubmit)="onSubmit()" class="reset-form">
                <div class="form-group">
                    <label class="form-label">New Password</label>
                    <div class="input-wrapper">
                        <i class="bi bi-lock input-icon"></i>
                        <input [type]="showPassword() ? 'text' : 'password'" class="form-control"
                            [(ngModel)]="newPassword" name="newPassword"
                            placeholder="Enter new password (min 8 characters)">
                        <button type="button" class="toggle-password" (click)="togglePassword()">
                            <i class="bi" [class.bi-eye]="!showPassword()" [class.bi-eye-slash]="showPassword()"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <div class="input-wrapper">
                        <i class="bi bi-lock-fill input-icon"></i>
                        <input [type]="showConfirmPassword() ? 'text' : 'password'" class="form-control"
                            [(ngModel)]="confirmPassword" name="confirmPassword"
                            placeholder="Confirm your new password">
                        <button type="button" class="toggle-password" (click)="toggleConfirmPassword()">
                            <i class="bi" [class.bi-eye]="!showConfirmPassword()"
                                [class.bi-eye-slash]="showConfirmPassword()"></i>
                        </button>
                    </div>
                </div>

                <button type="submit" class="btn-submit" [disabled]="isLoading()">
                    @if (isLoading()) {
                    <span class="spinner-border spinner-border-sm me-2"></span>
                    Resetting...
                    } @else {
                    Reset Password <i class="bi bi-arrow-right ms-2"></i>
                    }
                </button>
            </form>

            <div class="form-footer">
                <a routerLink="/login" class="back-link">
                    <i class="bi bi-arrow-left me-2"></i> Back to Login
                </a>
            </div>
            }
        </div>
    </div>
</div>